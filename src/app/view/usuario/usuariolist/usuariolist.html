<div class="main-container p-6 bg-white min-h-screen rounded-2xl shadow-xl">

  <!-- ENCABEZADO -->
  <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between mb-8 shadow-sm p-4 rounded-lg bg-red-50 border border-red-100">
    <h2 class="text-2xl font-bold text-red-700">Lista de Usuarios</h2>
    <button
      (click)="abrirModal()"
      class="mt-3 sm:mt-0 bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg shadow-md hover:shadow-lg transition-all duration-200 flex items-center gap-2"
    >
      <i class="fas fa-user-plus"></i> Crear nuevo
    </button>
  </div>

  <!-- FILTROS -->
  <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 mb-6 shadow-sm p-4 rounded-lg bg-white border border-gray-100">
    <input
      type="text"
      placeholder="Buscar por nombre o correo"
      class="border border-gray-300 rounded-lg px-3 py-2 shadow-sm focus:outline-none focus:ring-2 focus:ring-red-500"
      [(ngModel)]="filtroTexto"
      (input)="filtrar()"
    />

    <input
      type="date"
      class="border border-gray-300 rounded-lg px-3 py-2 shadow-sm focus:outline-none focus:ring-2 focus:ring-red-500"
      [(ngModel)]="filtroFecha"
      (change)="filtrar()"
    />

    <select
      class="border border-gray-300 rounded-lg px-3 py-2 shadow-sm focus:outline-none focus:ring-2 focus:ring-red-500"
      [(ngModel)]="filtroEstado"
      (change)="filtrar()"
    >
      <option value="">Todos</option>
      <option value="true">Activos</option>
      <option value="false">Inactivos</option>
    </select>
  </div>

  <!-- TABLA -->
  <div class="overflow-x-auto rounded-xl border border-gray-200 shadow-lg bg-white">
    <table class="min-w-full text-sm text-gray-800 rounded-lg overflow-hidden">
      <thead>
        <tr class="bg-red-600 text-white text-left shadow-sm">
          <th class="py-3 px-4">ID</th>
          <th class="py-3 px-4">Nombre</th>
          <th class="py-3 px-4">Correo</th>
          <th class="py-3 px-4">Rol</th>
          <th class="py-3 px-4">Fecha creaci√≥n</th>
          <th class="py-3 px-4">Estado</th>
          <th class="py-3 px-4 text-center">Acciones</th>
        </tr>
      </thead>
      <tbody>
        <tr
          *ngFor="let usuario of usuarios"
          class="hover:bg-red-50 transition-all border-b border-gray-100 hover:shadow-sm"
        >
          <td class="py-3 px-4 font-medium">{{ usuario.id }}</td>
          <td class="py-3 px-4">{{ usuario.nombre }}</td>
          <td class="py-3 px-4">{{ usuario.correo }}</td>
          <td class="py-3 px-4">{{ obtenerNombreRol(usuario.rolid) }}</td>
          <td class="py-3 px-4">{{ formatearFecha(usuario.fechacreacion) }}</td>
          <td class="py-3 px-4">
            <span
              class="font-semibold"
              [ngClass]="usuario.estado ? 'text-green-600' : 'text-red-600'"
            >
              {{ usuario.estado ? 'Activo' : 'Inactivo' }}
            </span>
          </td>
          <td class="py-3 px-4 text-center">
            <button
              (click)="abrirModal(usuario.id)"
              class="bg-yellow-400 hover:bg-yellow-500 text-white font-semibold px-3 py-1 rounded-md shadow-sm hover:shadow-md mr-2 transition"
            >
              Editar
            </button>
            <button
              (click)="eliminar(usuario.id)"
              class="bg-red-500 hover:bg-red-600 text-white font-semibold px-3 py-1 rounded-md shadow-sm hover:shadow-md transition"
            >
              Eliminar
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- MODAL -->
  <div
    *ngIf="mostrarModal"
    class="fixed inset-0 bg-black bg-opacity-40 flex justify-center items-center z-50"
  >
    <div
      class="bg-white w-full max-w-lg rounded-2xl shadow-2xl p-6 animate-fadeIn border border-red-100"
    >
      <div class="flex justify-between items-center border-b pb-3 mb-4">
        <h5 class="text-lg font-semibold text-gray-800">
          {{ usuarioEditandoId ? 'Editar Usuario' : 'Crear Usuario' }}
        </h5>
        <button
          (click)="cerrarModal()"
          class="text-gray-500 hover:text-red-600 transition"
        >
          <i class="fas fa-times text-xl"></i>
        </button>
      </div>

      <app-usuarioform
        [idUsuario]="usuarioEditandoId"
        (cerrar)="cerrarModal()"
        (onGuardado)="cargarUsuarios()"
      ></app-usuarioform>
    </div>
  </div>
</div>
